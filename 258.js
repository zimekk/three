(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[258],{9258:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var o=n(2784),i=n(3361),r=n(5654),a=n(8784),s=n(2955);class c extends s.Mesh{constructor(){super(new s.BoxGeometry(1,1,1),c.material)}}function l(e,t,n=new s.Vector3){const o=Math.PI*(e-.5),i=2*Math.PI*(t-.5);return n.x=Math.cos(i),n.y=Math.sin(o),n.z=Math.sin(i),n}(0,a.Z)(c,"SkyShader",{uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new s.Vector3},up:{value:new s.Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","#include <tonemapping_fragment>","#include <encodings_fragment>","}"].join("\n")}),(0,a.Z)(c,"material",new s.ShaderMaterial({name:"SkyShader",fragmentShader:c.SkyShader.fragmentShader,vertexShader:c.SkyShader.vertexShader,uniforms:s.UniformsUtils.clone(c.SkyShader.uniforms),side:s.BackSide,depthWrite:!1}));const u=o.forwardRef((({inclination:e=0,azimuth:t=.25,distance:n=100,mieCoefficient:i=.005,mieDirectionalG:a=.8,rayleigh:u=1,turbidity:m=2,sunPosition:h=l(e,t),...v},d)=>{const f=o.useMemo((()=>(new s.Vector3).setScalar(n)),[n]),[p]=o.useState((()=>new c));return o.createElement("primitive",(0,r.Z)({dispose:void 0,object:p,ref:d,"material-uniforms-mieCoefficient-value":i,"material-uniforms-mieDirectionalG-value":a,"material-uniforms-rayleigh-value":u,"material-uniforms-sunPosition-value":h,"material-uniforms-turbidity-value":m,scale:f},v))}));class m extends s.EventDispatcher{constructor(e,t){super(),(0,a.Z)(this,"camera",void 0),(0,a.Z)(this,"domElement",void 0),(0,a.Z)(this,"isLocked",!1),(0,a.Z)(this,"minPolarAngle",0),(0,a.Z)(this,"maxPolarAngle",Math.PI),(0,a.Z)(this,"changeEvent",{type:"change"}),(0,a.Z)(this,"lockEvent",{type:"lock"}),(0,a.Z)(this,"unlockEvent",{type:"unlock"}),(0,a.Z)(this,"euler",new s.Euler(0,0,0,"YXZ")),(0,a.Z)(this,"PI_2",Math.PI/2),(0,a.Z)(this,"vec",new s.Vector3),(0,a.Z)(this,"onMouseMove",(e=>{if(!1===this.isLocked)return;const t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;this.euler.setFromQuaternion(this.camera.quaternion),this.euler.y-=.002*t,this.euler.x-=.002*n,this.euler.x=Math.max(this.PI_2-this.maxPolarAngle,Math.min(this.PI_2-this.minPolarAngle,this.euler.x)),this.camera.quaternion.setFromEuler(this.euler),this.dispatchEvent(this.changeEvent)})),(0,a.Z)(this,"onPointerlockChange",(()=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(this.lockEvent),this.isLocked=!0):(this.dispatchEvent(this.unlockEvent),this.isLocked=!1)})),(0,a.Z)(this,"onPointerlockError",(()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")})),(0,a.Z)(this,"connect",(()=>{this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError)})),(0,a.Z)(this,"disconnect",(()=>{this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError)})),(0,a.Z)(this,"dispose",(()=>{this.disconnect()})),(0,a.Z)(this,"getObject",(()=>this.camera)),(0,a.Z)(this,"direction",new s.Vector3(0,0,-1)),(0,a.Z)(this,"getDirection",(e=>e.copy(this.direction).applyQuaternion(this.camera.quaternion))),(0,a.Z)(this,"moveForward",(e=>{this.vec.setFromMatrixColumn(this.camera.matrix,0),this.vec.crossVectors(this.camera.up,this.vec),this.camera.position.addScaledVector(this.vec,e)})),(0,a.Z)(this,"moveRight",(e=>{this.vec.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(this.vec,e)})),(0,a.Z)(this,"lock",(()=>{this.domElement.requestPointerLock()})),(0,a.Z)(this,"unlock",(()=>{this.domElement.ownerDocument.exitPointerLock()})),void 0===t&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),t=document.body),this.domElement=t,this.camera=e,this.connect()}}const h=o.forwardRef((({selector:e,...t},n)=>{const{camera:a,...s}=t,c=(0,i.Ky)((({gl:e})=>e)),l=(0,i.Ky)((({camera:e})=>e)),u=(0,i.Ky)((({invalidate:e})=>e)),h=a||l,[v]=o.useState((()=>new m(h,c.domElement)));return o.useEffect((()=>(null==v||null==v.addEventListener||v.addEventListener("change",u),()=>null==v||null==v.removeEventListener?void 0:v.removeEventListener("change",u))),[v,u]),o.useEffect((()=>{const t=()=>null==v?void 0:v.lock(),n=e?document.querySelector(e):document;return n&&n.addEventListener("click",t),()=>n?n.removeEventListener("click",t):void 0}),[v,e]),v?o.createElement("primitive",(0,r.Z)({ref:n,dispose:void 0,object:v},s)):null}));var v=n(248);const d=n.p+"eb5fc8ebf9c7a590fb3977d00d47e6ff.jpg",f=e=>{const[t]=(0,v.xK)((()=>({rotation:[-Math.PI/2,0,0],...e}))),n=(0,i.U2)(s.TextureLoader,d);return n.wrapS=n.wrapT=s.RepeatWrapping,n.repeat.set(240,240),o.createElement("mesh",{ref:t,receiveShadow:!0},o.createElement("planeGeometry",{args:[1e3,1e3]}),o.createElement("meshStandardMaterial",{map:n,color:"green"}))},p={KeyW:"forward",KeyS:"backward",KeyA:"left",KeyD:"right",Space:"jump"},E=e=>p[e],g=new s.Vector3,y=new s.Vector3,w=new s.Vector3,b=e=>{const[t,n]=(0,v.Eo)((()=>({mass:1,type:"Dynamic",position:[0,10,0],...e}))),{forward:r,backward:a,left:s,right:c,jump:l}=(()=>{const[e,t]=(0,o.useState)({forward:!1,backward:!1,left:!1,right:!1,jump:!1});return(0,o.useEffect)((()=>{const e=e=>t((t=>({...t,[E(e.code)]:!0}))),n=e=>t((t=>({...t,[E(e.code)]:!1})));return document.addEventListener("keydown",e),document.addEventListener("keyup",n),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",n)}}),[]),e})(),{camera:u}=(0,i.Ky)(),m=(0,o.useRef)([0,0,0]);return(0,o.useEffect)((()=>{n.velocity.subscribe((e=>m.current=e))}),[]),(0,i.xQ)((()=>{u.position.copy(t.current.position),y.set(0,0,Number(a)-Number(r)),w.set(Number(s)-Number(c),0,0),g.subVectors(y,w).normalize().multiplyScalar(5).applyEuler(u.rotation),n.velocity.set(g.x,m.current[1],g.z),l&&Math.abs(m.current[1].toFixed(2))<.05&&n.velocity.set(m.current[0],10,m.current[2])})),o.createElement("mesh",{ref:t})};var k=n(2467);const S=n.p+"59ed32793c180834b389d961c26f010c.jpg",x=(0,k.Z)((e=>({cubes:[[0,.5,-10]],addCube:(t,n,o)=>e((e=>({cubes:[...e.cubes,[t,n,o]]})))}))),P=()=>x((e=>e.cubes)).map(((e,t)=>o.createElement(M,{key:t,position:e}))),M=e=>{const[t]=(0,v.EJ)((()=>({type:"Static",...e}))),[n,r]=(0,o.useState)(null),a=x((e=>e.addCube)),c=(0,i.U2)(s.TextureLoader,S),l=(0,o.useCallback)((e=>(e.stopPropagation(),r(Math.floor(e.faceIndex/2)))),[]),u=(0,o.useCallback)((()=>r(null)),[]),m=(0,o.useCallback)((e=>{e.stopPropagation();const{x:n,y:o,z:i}=t.current.position;a(...[[n+1,o,i],[n-1,o,i],[n,o+1,i],[n,o-1,i],[n,o,i+1],[n,o,i-1]][Math.floor(e.faceIndex/2)])}),[]);return o.createElement("mesh",{ref:t,receiveShadow:!0,castShadow:!0,onPointerMove:l,onPointerOut:u,onClick:m},[...Array(6)].map(((e,t)=>o.createElement("meshStandardMaterial",{attachArray:"material",map:c,key:t,color:n===t?"hotpink":"white"}))),o.createElement("boxGeometry",null))};var L=n(6062),C=n.n(L),Z=n(3536);C()(Z.Z,{insert:"head",singleton:!1});const R=Z.Z.locals||{};function D(){return o.createElement(i.Xz,{shadows:!0,gl:{alpha:!1},camera:{fov:35}},o.createElement(u,{sunPosition:[100,10,100]}),o.createElement("ambientLight",{intensity:.3}),o.createElement("pointLight",{castShadow:!0,intensity:.8,position:[100,100,100]}),o.createElement(v.wI,{gravity:[0,-30,0]},o.createElement(f,null),o.createElement(b,null),o.createElement(P,null)),o.createElement(h,null))}function _(){const[e,t]=(0,o.useState)(!1);return o.createElement(o.Fragment,null,o.createElement(D,null),!e&&o.createElement("div",{className:R.overlay},o.createElement("div",null,"← Click the dot to start",o.createElement("br",null),o.createElement("span",{style:{marginLeft:18}},"Needs fullscreen to work!"))),o.createElement("div",{className:R.dot,style:{pointerEvents:e?"none":"all"},onClick:()=>t(!0)}))}},3536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(2609),i=n.n(o)()((function(e){return e[1]}));i.push([e.id,"._1hi8hrSuNSXcvtbuXDEsqU{position:absolute;top:0;left:0;width:100%;height:100%;background:#272730c0;display:flex;align-items:center;justify-content:center}._1hi8hrSuNSXcvtbuXDEsqU>div{position:relative;margin-top:15px;margin-left:280px;background:#000;color:#fff;padding:10px 20px;border-radius:5px}.gQ2_UOSA_5lnRAC6rbVkm{position:absolute;top:50%;left:50%;width:10px;height:10px;border-radius:50%;transform:translate3d(-50%, -50%, 0);cursor:pointer;border:2px solid #fff}",""]),i.locals={overlay:"_1hi8hrSuNSXcvtbuXDEsqU",dot:"gQ2_UOSA_5lnRAC6rbVkm"};const r=i},8784:(e,t,n)=>{"use strict";function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:()=>o})}}]);